<?xml version="1.0" encoding="utf-8"?>
<dataController name="schvchdlyhdreg4" label="schvchdlyhdreg4" conflictDetection="overwriteChanges" plugIn="eZee.Data.AnnotationPlugIn" handler="eZee.Rules.schvchdlyhdreg4BusinessRules" xmlns="urn:schemas-codeontime-com:data-aquarium">
  <commands>
    <command id="command1" type="Text">
      <text><![CDATA[SELECT        schvchdlyhdreg.schvchdlyhdregid, schvchdlyhdreg.sgm, sgm.sgm_Nm AS sgmsgm_Nm, sgmOpco.OpcoName AS sgmOpcoOpcoName, schvchdlyhdreg.Trs_Dt, schvchdlyhdreg.Balance, 
                         schvchdlyhdreg.ReferanceNo, schvchdlyhdreg.IDregorg, IDregorg.NAME_1 AS IDregorgNAME_1, schvchdlyhdreg.Delevername, schvchdlyhdreg.Delevercivil, schvchdlyhdreg.DeleverTel, schvchdlyhdreg.Notes, 
                         schvchdlyhdreg.approved, schvchdlyhdreg.posted, schvchdlyhdreg.deleted, schvchdlyhdreg.havdetails, schvchdlyhdreg.branch, Thebranch.Desc1 AS ThebranchDesc1, 
                         Thebranchsgm.sgm_Nm AS Thebranchsgmsgm_Nm, ThebranchsgmOpco.OpcoName AS ThebranchsgmOpcoOpcoName, ThebranchGender.Gender AS ThebranchGenderGender, 
                         Thebranchstage.ShortDesc1 AS ThebranchstageShortDesc1, Thebranchschtyp.schtypDesc AS ThebranchschtypschtypDesc, schvchdlyhdreg.ModifiedBy, schvchdlyhdreg.ModifiedOn, schvchdlyhdreg.CreatedBy, 
                         schvchdlyhdreg.CreatedOn, dbo.Qschvchdlydetailreg1002.countofdetails, dbo.Qschvchdlydetailreg1002.countofpayments, dbo.Qschvchdlydetailreg1002.studentlist, schvchdlyhdreg.acdcode, 
                         dbo.schAcademicyear.AcademicYear, dbo.schAcademicyear.startdate, dbo.schAcademicyear.enddate, dbo.schAcademicyear.GlFinperiodID, dbo.schAcademicyear.startdatein, 
                         dbo.schAcademicyear.startdatepaystart, dbo.Qschvchdlydetailreg1003.StudentCode, dbo.Qschvchdlydetailreg1003.civilidst, dbo.Qschvchdlydetailreg1003.studentfullname, 
                         dbo.Qschvchdlydetailreg1003.Fathername, dbo.Qschvchdlydetailreg1003.fathertel3
FROM            dbo.schvchdlyhdreg AS schvchdlyhdreg LEFT OUTER JOIN
                         dbo.schAcademicyear ON schvchdlyhdreg.acdcode = dbo.schAcademicyear.Code LEFT OUTER JOIN
                         dbo.Qschvchdlydetailreg1002 ON schvchdlyhdreg.schvchdlyhdregid = dbo.Qschvchdlydetailreg1002.schvchdlyhdregid LEFT OUTER JOIN
                         dbo.Qschvchdlydetailreg1003 ON schvchdlyhdreg.schvchdlyhdregid = dbo.Qschvchdlydetailreg1003.schvchdlyhdregid LEFT OUTER JOIN
                         dbo.glmulcmp AS sgm ON schvchdlyhdreg.sgm = sgm.sgmid LEFT OUTER JOIN
                         dbo.OpCo AS sgmOpco ON sgm.OpcoID = sgmOpco.OpcoIDidentity LEFT OUTER JOIN
                         dbo.REG_ORGANIZATIONS AS IDregorg ON schvchdlyhdreg.IDregorg = IDregorg.IDIDregorg LEFT OUTER JOIN
                         dbo.schBranch AS Thebranch ON schvchdlyhdreg.branch = Thebranch.branch LEFT OUTER JOIN
                         dbo.glmulcmp AS Thebranchsgm ON Thebranch.sgm = Thebranchsgm.sgmid LEFT OUTER JOIN
                         dbo.OpCo AS ThebranchsgmOpco ON Thebranchsgm.OpcoID = ThebranchsgmOpco.OpcoIDidentity LEFT OUTER JOIN
                         dbo.PyGender AS ThebranchGender ON Thebranch.Genderid = ThebranchGender.Genderid LEFT OUTER JOIN
                         dbo.schStage AS Thebranchstage ON Thebranch.stagecode = Thebranchstage.Code LEFT OUTER JOIN
                         dbo.schtyp AS Thebranchschtyp ON Thebranch.schtypid = Thebranchschtyp.schtypid]]></text>
    </command>
    <command id="schvchdlyhdregidIdentityCommand" type="Text" event="Inserted">
      <text><![CDATA[select @@identity]]></text>
      <output>
        <fieldOutput fieldName="schvchdlyhdregid" />
      </output>
    </command>
  </commands>
  <fields>
    <field name="schvchdlyhdregid" type="Int64" allowNulls="false" isPrimaryKey="true" label="Schvchdlyhdregid" readOnly="true" />
    <field name="branch" type="Int64" allowNulls="false" label="Branch" showInSummary="true" allowLEV="true">
      <items style="DropDownList" dataController="schBranch" newDataView="createForm1" searchOnStart="true" dataView="grid1" dataTextField="Desc1" copy="sgm=sgm" dataValueField="branch" />
    </field>
    <field name="ThebranchDesc1" type="String" readOnly="true" label="Thebranch Desc1" length="50" />
    <field name="Thebranchsgmsgm_Nm" type="String" readOnly="true" label="Thebranchsgmsgm Nm" length="255" />
    <field name="ThebranchsgmOpcoOpcoName" type="String" readOnly="true" label="Thebranchsgm Opco Name" length="50" />
    <field name="ThebranchGenderGender" type="String" readOnly="true" label="Thebranch Gender" length="100" />
    <field name="ThebranchstageShortDesc1" type="String" readOnly="true" label="Thebranchstage Short Desc1" length="50" />
    <field name="ThebranchschtypschtypDesc" type="String" readOnly="true" label="Thebranchschtypschtyp Desc" length="150" />
    <field name="sgm" type="Int64" allowNulls="false" label="Sgm" showInSummary="true" allowLEV="true">
      <items style="DropDownList" dataController="glmulcmp" newDataView="createForm1" searchOnStart="true" dataView="grid1" dataTextField="sgm_Nm" dataValueField="sgm" />
    </field>
    <field name="sgmsgm_Nm" type="String" readOnly="true" label="sgmsgm Nm" length="255" />
    <field name="sgmOpcoOpcoName" type="String" readOnly="true" label="sgm Opco Name" length="50" />
    <field name="Trs_Dt" type="DateTime" default="(getdate())" label="Trs Dt" showInSummary="true" />
    <field name="Balance" type="Decimal" label="Balance" showInSummary="true" />
    <field name="ReferanceNo" type="Int64" label="Referance No" showInSummary="true" contextFields="sgm,branch,Trs_Dt" calculated="true" allowNulls="false" maskType="Number" />
    <field name="IDregorg" type="Int64" label="I Dregorg" />
    <field name="Delevername" type="String" label="Delevername" length="100" />
    <field name="Delevercivil" type="String" allowQBE="false" allowSorting="false" label="Delevercivil" length="-1" />
    <field name="DeleverTel" type="String" label="Delever Tel" length="100" />
    <field name="Notes" type="String" label="Notes" length="100" contextFields="schvchdlydetailreg,schvchdlydetailpayment" />
    <field name="approved" type="Boolean" default="((0))" label="Approved" />
    <field name="posted" type="Boolean" default="((0))" label="Posted" />
    <field name="deleted" type="Boolean" default="((0))" label="Deleted" />
    <field name="havdetails" type="Boolean" default="((0))" label="Havdetails" />
    <field name="ModifiedBy" type="String" label="Modified By" length="50" />
    <field name="ModifiedOn" type="DateTime" label="Modified On" />
    <field name="CreatedBy" type="String" label="Created By" length="50" />
    <field name="CreatedOn" type="DateTime" label="Created On" />
    <field name="acdcode" type="Int64" allowNulls="false" default="50" label="Acdcode" allowLEV="true">
      <items style="DropDownList" dataController="schAcademicyear" newDataView="createForm1" searchOnStart="true" />
    </field>
    <field name="acdAcademicYear" type="String" readOnly="true" label="acd Academic Year" length="150" />
    <field name="auditing" type="Boolean" label="Auditing" />
    <field name="auditnotes" type="String" allowQBE="false" allowSorting="false" label="Auditnotes" length="-1" />
    <field name="rosom" type="Decimal" default="((0))" label="Rosom" />
    <field name="Bookrosom" type="Decimal" default="((0))" label="Bookrosom" />
    <field name="Transportation" type="Decimal" default="((0))" label="Transportation" />
    <field name="rosomregister" type="Decimal" default="((0))" label="Rosomregister" />
    <field name="Cash" type="Decimal" default="((0))" label="Cash" />
    <field name="keynet" type="Decimal" label="Keynet" />
    <field name="transno" type="Int64" default="((1))" label="Transno" />
    <field name="checkvalue" type="Decimal" label="Checkvalue" />
    <field name="checknumber" type="Decimal" label="Checknumber" />
    <field name="TRANSFER" type="Decimal" label="Transfer" />
    <field name="DISTRIBUTION" type="Decimal" default="((0))" label="Distribution" />
    <field name="Sumofdebitcal1" type="Decimal" label="Sumofdebitcal1" />
    <field name="Sumofcerditcal" type="Decimal" label="Sumofcerditcal" />
    <field name="totalbalance1" type="Decimal" label="Totalbalance1" />
    <field name="Pymnt_No" type="Int64" default="((1))" label="Pymnt No" />
    <field name="schBnk_No" type="Int64" label="sch Bnk No" />
    <field name="checkAccount" type="String" label="check Account" length="50" />
    <field name="moneypaidto" type="Decimal" label="Moneypaidto" />
    <field name="checkdate" type="DateTime" label="Checkdate" />
    <field name="sumofdebit" type="Decimal" label="Sumofdebit" contextFields="schvchdlydetailreg,schvchdlydetailpayment">
      <formula>select count(*) from schvchdlydetailreg where schvchdlyhdregid=@schvchdlyhdregid</formula>
    </field>
    <field name="fathercode" type="Int64" label="Fathercode" />
    <field name="printcount" type="Int64" label="Printcount" />
    <field name="schpaymenttypeid" type="Int64" label="Schpaymenttypeid" />
    <field name="countofdetails" type="Int64" readOnly="true" label="countofdetails" hidden="false">
      <items letters="false" />
      <formula />
    </field>
    <field name="countofpayments" type="Int64" readOnly="true" label="countofpayments" hidden="false">
      <items letters="false" />
      <formula />
    </field>
    <field name="studentlist" type="String" readOnly="true" label="studentlist" hidden="false" length="4000">
      <items letters="false" />
    </field>
    <field name="AcademicYear" type="String" readOnly="true" label="AcademicYear" hidden="false">
      <items letters="false" />
    </field>
     <field name="civilidst" type="String" readOnly="true" label="Student  Civilidnumber" length="50" />
     <field name="StudentCode" type="String" readOnly="true" label="StudentCode" length="50" />	 
     <field name="fathertel3" type="String" readOnly="true" label="fathertel3 " length="50" />
     <field name="Fathername" type="String" readOnly="true" label="Fathername" length="50" />	 
     <field name="studentfullname" type="String" readOnly="true" label="studentfullname" length="50" />
	 
  </fields>
  <views>
    <view id="grid1" type="Grid" commandId="command1" label="Schvchdlyhdreg" sortExpression="schvchdlyhdregid Desc" filter="approved='True' and ReferanceNo=0">
   
      <dataFields>
        <dataField fieldName="branch" aliasFieldName="ThebranchDesc1" />
        <dataField fieldName="sgm" aliasFieldName="sgmsgm_Nm" hidden="true"/>
        <dataField fieldName="schvchdlyhdregid" />
        <dataField fieldName="Trs_Dt" columns="10" textMode="Static" />
        <dataField fieldName="Balance" columns="15" textMode="Static" />
        <dataField fieldName="ReferanceNo" columns="15" />
        <dataField fieldName="Notes" hidden="true"/>
        <dataField fieldName="approved" hidden="true"/>
        <dataField fieldName="CreatedBy" columns="50" />
        <dataField fieldName="CreatedOn" columns="10" hidden="true"/>
        <dataField fieldName="sumofdebit" textMode="Static" hidden="true"/>
        <dataField fieldName="countofdetails" columns="15" hidden="true"/>
        <dataField fieldName="countofpayments" columns="15" hidden="true"/>
        <dataField fieldName="acdcode" aliasFieldName="acdAcademicYear" hidden="false" />
        <dataField fieldName="AcademicYear" rows="5" hidden="true"/>
		 <dataField fieldName="civilidst"  />
		 <dataField fieldName="StudentCode"  />
		  <dataField fieldName="studentfullname"  />
		  <dataField fieldName="fathertel3"  />
		   <dataField fieldName="Fathername"  />
		
	 
      </dataFields>
    </view>
    <view id="editForm1" type="Form" commandId="command1" label="Review Schvchdlyhdreg">
      <headerText>$DefaultEditViewDescription</headerText>
      <categories>
        <category id="c1" flow="NewColumn"  newColumn="true">
          <description />
          <dataFields>
            <dataField fieldName="acdcode" aliasFieldName="acdAcademicYear" />
            <dataField fieldName="schvchdlyhdregid" />
            <dataField fieldName="branch" aliasFieldName="ThebranchDesc1" />
            <dataField fieldName="IDregorg" columns="15" />
            <dataField fieldName="Balance" columns="15" textMode="Static" />
            <dataField fieldName="auditing" />
            <dataField fieldName="auditnotes" rows="5" />
            <dataField fieldName="rosom" dataFormatString="c" columns="15" />
            <dataField fieldName="Bookrosom" dataFormatString="c" columns="15" />
            <dataField fieldName="Transportation" dataFormatString="c" columns="15" />
            <dataField fieldName="rosomregister" dataFormatString="c" columns="15" />
            <dataField fieldName="Cash" dataFormatString="c" columns="15" />
            <dataField fieldName="keynet" dataFormatString="c" columns="15" />
            <dataField fieldName="transno" columns="15" />
            <dataField fieldName="checkvalue" dataFormatString="c" columns="15" />
            <dataField fieldName="checknumber" dataFormatString="c" columns="15" />
            <dataField fieldName="TRANSFER" dataFormatString="c" columns="15" />
            <dataField fieldName="DISTRIBUTION" dataFormatString="c" columns="15" />
            <dataField fieldName="Sumofdebitcal1" dataFormatString="c" columns="15" />
            <dataField fieldName="Sumofcerditcal" dataFormatString="c" columns="15" />
            <dataField fieldName="totalbalance1" dataFormatString="c" columns="15" />
            <dataField fieldName="Pymnt_No" columns="15" />
            <dataField fieldName="schBnk_No" columns="15" />
            <dataField fieldName="checkAccount" columns="50" />
            <dataField fieldName="moneypaidto" dataFormatString="c" columns="15" />
            <dataField fieldName="checkdate" columns="10" />
            <dataField fieldName="fathercode" columns="15" />
            <dataField fieldName="printcount" columns="15" />
            <dataField fieldName="schpaymenttypeid" columns="15" />
            <dataField fieldName="approved" hidden="true" />
            <dataField fieldName="sgm" aliasFieldName="sgmsgm_Nm" textMode="Static" />
          </dataFields>
        </category>
        <category id="c3" flow="NewColumn"  newColumn="true">
          <dataFields>
            <dataField fieldName="Trs_Dt" columns="10" textMode="Text" />
            <dataField fieldName="ReferanceNo" columns="15" />
            <dataField fieldName="DeleverTel" />
            <dataField fieldName="Delevercivil" rows="5" />
            <dataField fieldName="Delevername" />
            <dataField fieldName="Notes" rows="1" />
            <dataField fieldName="deleted" hidden="true" />
            <dataField fieldName="sumofdebit" dataFormatString="c" columns="15" textMode="Static" />
          </dataFields>
        </category>
      </categories>
    </view>
    <view id="createForm1" type="Form" commandId="command1" label="New Schvchdlyhdreg">
      <categories>
        <category id="c1" flow="NewColumn"  newColumn="true">
          <description />
          <dataFields>
            <dataField fieldName="acdcode" aliasFieldName="acdAcademicYear" />
            <dataField fieldName="branch" aliasFieldName="ThebranchDesc1" />
            <dataField fieldName="sgm" aliasFieldName="sgmsgm_Nm" textMode="Static" />
            <dataField fieldName="IDregorg" columns="15" />
            <dataField fieldName="Balance" columns="15" textMode="Static" />
            <dataField fieldName="auditing" />
            <dataField fieldName="auditnotes" rows="5" />
            <dataField fieldName="rosom" dataFormatString="c" columns="15" />
            <dataField fieldName="Bookrosom" dataFormatString="c" columns="15" />
            <dataField fieldName="Transportation" dataFormatString="c" columns="15" />
            <dataField fieldName="rosomregister" dataFormatString="c" columns="15" />
            <dataField fieldName="Cash" dataFormatString="c" columns="15" />
            <dataField fieldName="keynet" dataFormatString="c" columns="15" />
            <dataField fieldName="transno" columns="15" />
            <dataField fieldName="checkvalue" dataFormatString="c" columns="15" />
            <dataField fieldName="checknumber" dataFormatString="c" columns="15" />
            <dataField fieldName="TRANSFER" dataFormatString="c" columns="15" />
            <dataField fieldName="DISTRIBUTION" dataFormatString="c" columns="15" />
            <dataField fieldName="Sumofdebitcal1" dataFormatString="c" columns="15" />
            <dataField fieldName="Sumofcerditcal" dataFormatString="c" columns="15" />
            <dataField fieldName="totalbalance1" dataFormatString="c" columns="15" />
            <dataField fieldName="Pymnt_No" columns="15" />
            <dataField fieldName="schBnk_No" columns="15" />
            <dataField fieldName="checkAccount" columns="50" />
            <dataField fieldName="moneypaidto" dataFormatString="c" columns="15" />
            <dataField fieldName="checkdate" columns="10" />
            <dataField fieldName="fathercode" columns="15" />
            <dataField fieldName="printcount" columns="15" />
            <dataField fieldName="schpaymenttypeid" columns="15" />
            <dataField fieldName="deleted" hidden="true" />
            <dataField fieldName="havdetails" hidden="true" />
            <dataField fieldName="approved" hidden="true" />
          </dataFields>
        </category>
        <category id="c3" flow="NewColumn"  newColumn="true">
          <dataFields>
            <dataField fieldName="Trs_Dt" columns="10" textMode="Text" />
            <dataField fieldName="ReferanceNo" columns="15" />
            <dataField fieldName="DeleverTel" columns="12" />
            <dataField fieldName="Delevercivil" rows="5" />
            <dataField fieldName="Delevername" columns="50" />
            <dataField fieldName="Notes" rows="1" columns="50" />
            <dataField fieldName="sumofdebit" dataFormatString="c" columns="15" textMode="Static" />
          </dataFields>
        </category>
      </categories>
    </view>
    <view id="grid2" commandId="command1" type="Grid" label="grid2" filter="(approved='True' and havdetails='True' and posted='True' )&#xD;&#xA;">
      <dataFields>
        <dataField fieldName="schvchdlyhdregid" />
        <dataField fieldName="Trs_Dt" columns="10" textMode="Static" />
        <dataField fieldName="Balance" dataFormatString="c" columns="15" textMode="Static" />
        <dataField fieldName="Notes" />
        <dataField fieldName="approved" />
        <dataField fieldName="posted" />
        <dataField fieldName="ModifiedBy" columns="50" />
        <dataField fieldName="ModifiedOn" columns="10" />
        <dataField fieldName="CreatedBy" columns="50" />
        <dataField fieldName="CreatedOn" columns="10" />
        <dataField fieldName="sumofdebit" textMode="Static" />
        <dataField fieldName="Trcrvalue" columns="15" />
      </dataFields>
    </view>
    <view id="GRIDALL" commandId="command1" type="Grid" label="GRIDALL" baseViewId="grid1" />
    <view id="grid3" commandId="command1" type="Grid" label="grid3" />
  </views>
  <actions>
    <actionGroup id="ag1" scope="Grid">
      <action id="a1" commandName="Select" commandArgument="editForm1" />
         </actionGroup>
    <actionGroup id="ag6" scope="ActionBar" headerText="Record">
      <action id="a1" whenLastCommandName="Edit" commandName="1001" />
 
    </actionGroup>
    <actionGroup id="ag7" scope="ActionBar" headerText="Report">
      <action id="a1" commandName="109" />
     </actionGroup>
	 <actionGroup id="ag9" scope="ActionColumn">
      <action commandName="SQL" headerText="Print" confirmation="Are you sure you want to approved ?" id="a101" >
        <data><![CDATA[
		declare @maxrefno bigint
		Set @maxrefno=(select max(ReferanceNo) + 1 from [schvchReferancno] where sgm=@sgm)
		update [dbo].[schvchdlyhdreg]  set ReferanceNo=@maxrefno where schvchdlyhdregid = @schvchdlyhdregid
		---set @Result_RefreshChildren=1
		set @Result_Refresh=1
		set @Result_NavigateUrl = '_blank:webreportviwer.aspx?reportquery=schvchdlyhdreg&idfilter=' + cast( @schvchdlyhdregid  as nvarchar)
                          + '&sosoname=' + cast( @sgm  as nvarchar) + '&myvar1=' + cast( @acdcode  as nvarchar) 
                          + '&myvar2=' + cast( @branch  as nvarchar) 
                       ]]></data>
      </action>
      <action commandName="SQL" headerText="Edit" confirmation="Are you sure you want to Edit ?" id="a100">
        <data><![CDATA[
	set @Result_NavigateUrl = '_blank:ReciptVoucher1.aspx?schvchdlyhdregid=' + cast( @schvchdlyhdregid  as nvarchar)
                          + '&_controller=schvchdlyhdreg&_commandName=Edit'
                          + '&_commandArgument=editForm1'
]]></data>
      </action>
    </actionGroup>
  </actions>
  <businessRules>
 
    <rule id="r101" commandName="Custom" commandArgument="FullDuplicatewithDetails" type="Sql" phase="Execute"><![CDATA[-- duplicate the order
INSERT INTO [dbo].[schvchdlyhdreg]
           ([sgm]
           ,[Trs_Dt]
           ,[Balance]
           ,[ReferanceNo]
           ,[IDregorg]
           ,[Delevername]
           ,[Delevercivil]
           ,[DeleverTel]
           ,[Notes]
           ,[approved]
           ,[posted]
           ,[deleted]
           ,[havdetails]
           ,[branch]
           ,[acdcode]
           ,[CreatedBy]
           ,[CreatedOn]
           )
select [sgm]
           ,[Trs_Dt]
           ,[Balance]
           ,0 as [ReferanceNo]
           ,[IDregorg]
           ,[Delevername]
           ,[Delevercivil]
           ,[DeleverTel]
           ,[Notes]
           ,0 as [approved]
           ,0 as [posted]
           ,0 as [deleted]
           ,0 as [havdetails]
           ,[branch]
           ,[acdcode]
            ,[CreatedBy]
           ,[CreatedOn]
from [dbo].[schvchdlyhdreg]
where schvchdlyhdregid = @schvchdlyhdregid

-- find ID of duplicated order
declare @newschvchdlyhdregid int;
select @newschvchdlyhdregid = @@IDENTITY;

-- duplicate order details
INSERT INTO [dbo].[schvchdlydetailreg]
           ([schvchdlyhdregid]
           ,[branch]
           ,[acdcode]
           ,[StudentCode]
           ,[FatherCode]
           ,[Trsd_Dt]
           ,[schpaymenttypeid]
           ,[Mony_Paid]
           ,[Notes])
SELECT 
@newschvchdlyhdregid 
           ,[branch]
           ,[acdcode]
           ,[StudentCode]
           ,[FatherCode]
           ,[Trsd_Dt]
           ,[schpaymenttypeid]
           ,[Mony_Paid]
           ,[Notes]

from [dbo].[schvchdlydetailreg]
where schvchdlyhdregid =@schvchdlyhdregid 
--
-- duplicate order details
INSERT INTO [dbo].[schvchdlydetailpayment]
           ([schvchdlyhdregid]
           ,[Pymnt_No]
           ,[paymentwaynumber]
           ,[cstyp_no]
           ,[subaccountno]
           ,[Acc_no]
           ,[schBnk_No]
           ,[checkAccount]
           ,[checkdate]
           ,[moneypaidto])

SELECT 

@newschvchdlyhdregid 
      ,[Pymnt_No]
      ,[paymentwaynumber]
      ,[cstyp_no]
      ,[subaccountno]
      ,[Acc_no]
      ,[schBnk_No]
      ,[checkAccount]
      ,[checkdate]
      ,[moneypaidto]

      FROM [dbo].[schvchdlydetailpayment]
where schvchdlyhdregid =@schvchdlyhdregid 

-- open edit form for duplicate order
set @Result_NavigateUrl = 'ReciptVoucher1.aspx?schvchdlyhdregid=' + cast( @newschvchdlyhdregid  as nvarchar)
                          + '&_controller=schvchdlyhdreg&_commandName=Edit'
                          + '&_commandArgument=editForm1']]></rule>
    <rule id="r102" commandName="Update" type="Sql" phase="Before"><![CDATA[
	delete from  schvchdlydetailregtmp  where schvchdlyhdregid=@schvchdlyhdregid
	]]></rule>
   <rule id="r105" commandName="Update" type="Sql" phase="After"  ><![CDATA[
set @Result_NavigateUrl = 'webreportviwer.aspx?reportquery=' + @Arguments_Controller    + '&idfilter=' + cast(@schvchdlyhdregid as nvarchar) ]]></rule>

  </businessRules>
</dataController>